jQuery.iDrop={fit:function(a,b,c,d){return a<=jQuery.iDrag.dragged.dragCfg.nx&&a+c>=jQuery.iDrag.dragged.dragCfg.nx+jQuery.iDrag.dragged.dragCfg.oC.w&&b<=jQuery.iDrag.dragged.dragCfg.ny&&b+d>=jQuery.iDrag.dragged.dragCfg.ny+jQuery.iDrag.dragged.dragCfg.oC.h?true:false},intersect:function(a,b,c,d){return!(a>jQuery.iDrag.dragged.dragCfg.nx+jQuery.iDrag.dragged.dragCfg.oC.w||a+c<jQuery.iDrag.dragged.dragCfg.nx||b>jQuery.iDrag.dragged.dragCfg.ny+jQuery.iDrag.dragged.dragCfg.oC.h||b+d<jQuery.iDrag.dragged.dragCfg.ny)? true:false},pointer:function(a,b,c,d){return a<jQuery.iDrag.dragged.dragCfg.currentPointer.x&&a+c>jQuery.iDrag.dragged.dragCfg.currentPointer.x&&b<jQuery.iDrag.dragged.dragCfg.currentPointer.y&&b+d>jQuery.iDrag.dragged.dragCfg.currentPointer.y?true:false},overzone:false,highlighted:{},count:0,zones:{},highlight:function(a){if(jQuery.iDrag.dragged!=null){var b;jQuery.iDrop.highlighted={};var c=false;for(b in jQuery.iDrop.zones)if(jQuery.iDrop.zones[b]!=null){var d=jQuery.iDrop.zones[b].get(0);if(jQuery(jQuery.iDrag.dragged).is("."+ d.dropCfg.a)){if(d.dropCfg.m==false){d.dropCfg.p=jQuery.extend(jQuery.iUtil.getPositionLite(d),jQuery.iUtil.getSizeLite(d));d.dropCfg.m=true}d.dropCfg.ac&&jQuery.iDrop.zones[b].addClass(d.dropCfg.ac);jQuery.iDrop.highlighted[b]=jQuery.iDrop.zones[b];if(jQuery.iSort&&d.dropCfg.s&&jQuery.iDrag.dragged.dragCfg.so){d.dropCfg.el=jQuery("."+d.dropCfg.a,d);a.style.display="none";jQuery.iSort.measure(d);d.dropCfg.os=jQuery.iSort.serialize(jQuery.attr(d,"id")).hash;a.style.display=a.dragCfg.oD;c=true}d.dropCfg.onActivate&& d.dropCfg.onActivate.apply(jQuery.iDrop.zones[b].get(0),[jQuery.iDrag.dragged])}}c&&jQuery.iSort.start()}},remeasure:function(){jQuery.iDrop.highlighted={};for(i in jQuery.iDrop.zones)if(jQuery.iDrop.zones[i]!=null){var a=jQuery.iDrop.zones[i].get(0);if(jQuery(jQuery.iDrag.dragged).is("."+a.dropCfg.a)){a.dropCfg.p=jQuery.extend(jQuery.iUtil.getPositionLite(a),jQuery.iUtil.getSizeLite(a));a.dropCfg.ac&&jQuery.iDrop.zones[i].addClass(a.dropCfg.ac);jQuery.iDrop.highlighted[i]=jQuery.iDrop.zones[i];if(jQuery.iSort&& a.dropCfg.s&&jQuery.iDrag.dragged.dragCfg.so){a.dropCfg.el=jQuery("."+a.dropCfg.a,a);elm.style.display="none";jQuery.iSort.measure(a);elm.style.display=elm.dragCfg.oD}}}},checkhover:function(a){if(jQuery.iDrag.dragged!=null){jQuery.iDrop.overzone=false;var b,c=false,d=0;for(b in jQuery.iDrop.highlighted){var e=jQuery.iDrop.highlighted[b].get(0);if(jQuery.iDrop.overzone==false&&jQuery.iDrop[e.dropCfg.t](e.dropCfg.p.x,e.dropCfg.p.y,e.dropCfg.p.wb,e.dropCfg.p.hb)){e.dropCfg.hc&&e.dropCfg.h==false&&jQuery.iDrop.highlighted[b].addClass(e.dropCfg.hc); if(e.dropCfg.h==false&&e.dropCfg.onHover)c=true;e.dropCfg.h=true;jQuery.iDrop.overzone=e;if(jQuery.iSort&&e.dropCfg.s&&jQuery.iDrag.dragged.dragCfg.so){jQuery.iSort.helper.get(0).className=e.dropCfg.shc;jQuery.iSort.checkhover(e)}d++}else if(e.dropCfg.h==true){e.dropCfg.onOut&&e.dropCfg.onOut.apply(e,[a,jQuery.iDrag.helper.get(0).firstChild,e.dropCfg.fx]);e.dropCfg.hc&&jQuery.iDrop.highlighted[b].removeClass(e.dropCfg.hc);e.dropCfg.h=false}}if(jQuery.iSort&&!jQuery.iDrop.overzone&&jQuery.iDrag.dragged.so)jQuery.iSort.helper.get(0).style.display= "none";c&&jQuery.iDrop.overzone.dropCfg.onHover.apply(jQuery.iDrop.overzone,[a,jQuery.iDrag.helper.get(0).firstChild])}},checkdrop:function(a){var b;for(b in jQuery.iDrop.highlighted){var c=jQuery.iDrop.highlighted[b].get(0);c.dropCfg.ac&&jQuery.iDrop.highlighted[b].removeClass(c.dropCfg.ac);c.dropCfg.hc&&jQuery.iDrop.highlighted[b].removeClass(c.dropCfg.hc);if(c.dropCfg.s)jQuery.iSort.changed[jQuery.iSort.changed.length]=b;if(c.dropCfg.onDrop&&c.dropCfg.h==true){c.dropCfg.h=false;c.dropCfg.onDrop.apply(c, [a,c.dropCfg.fx])}c.dropCfg.m=false;c.dropCfg.h=false}jQuery.iDrop.highlighted={}},destroy:function(){return this.each(function(){if(this.isDroppable){if(this.dropCfg.s){id=jQuery.attr(this,"id");jQuery.iSort.collected[id]=null;jQuery("."+this.dropCfg.a,this).DraggableDestroy()}jQuery.iDrop.zones["d"+this.idsa]=null;this.isDroppable=false;this.f=null}})},build:function(a){return this.each(function(){if(!(this.isDroppable==true||!a.accept||!jQuery.iUtil||!jQuery.iDrag)){this.dropCfg={a:a.accept,ac:a.activeclass|| false,hc:a.hoverclass||false,shc:a.helperclass||false,onDrop:a.ondrop||a.onDrop||false,onHover:a.onHover||a.onhover||false,onOut:a.onOut||a.onout||false,onActivate:a.onActivate||false,t:a.tolerance&&(a.tolerance=="fit"||a.tolerance=="intersect")?a.tolerance:"pointer",fx:a.fx?a.fx:false,m:false,h:false};if(a.sortable==true&&jQuery.iSort){id=jQuery.attr(this,"id");jQuery.iSort.collected[id]=this.dropCfg.a;this.dropCfg.s=true;if(a.onChange){this.dropCfg.onChange=a.onChange;this.dropCfg.os=jQuery.iSort.serialize(id).hash}}this.isDroppable= true;this.idsa=parseInt(Math.random()*1E4);jQuery.iDrop.zones["d"+this.idsa]=jQuery(this);jQuery.iDrop.count++}})}};jQuery.fn.extend({DroppableDestroy:jQuery.iDrop.destroy,Droppable:jQuery.iDrop.build});jQuery.recallDroppables=jQuery.iDrop.remeasure;