/**
 * Feed view controller
 * @author Peng Wang
 * @version 1
 * @requires jQuery 1.4+, jQuery.tmpl, feed API scripts, feed templates
 * @todo queue box-height animation after fadeOut before fadeIn
 */

(function(a){a.pjp=a.pjp||{};a.pjp.pager={options:{}}})(jQuery);
window.Site&&Site.serviceUrl&&Site.feedApiData&&jQuery.tmpl&&function(a){var m=function(c){var b=0,e=0,d=[],f;a.each(Site.feedApiData,function(g,i){var h=Site.serviceUrl+"/feed."+g+".php?"+a.param(i),k;e+=1;a.getJSON(h,function(j){j=l(j,g);k=a("#tpl-"+g+"-feed").render(j);d.push(a(k).html());b+=1;if(b===e){f=a("#tpl-feeds-container").render({feeds:d.join("\n")});c(a(f).html())}})})},l=function(c,b){switch(b){case "posterous":a.each(c.post,function(){a.extend(this,{humanDate:function(){return(new Date(this.date)).toDateString().replace(/\d{4}$/,
"")},tags:function(){return this.tag.join(", ")}})});break}return c};a(document).ready(function(){var c=a("#content #ouFeed:eq(0) .in"),b=a("a.jFeed:eq(0)",c),e=a(".bd.mnLinked:eq(0)",c),d,f=function(){b.find(".jOn").hide().end().find(".jOff").show();e.fadeOut("fast",function(){d.fadeIn("fast")})},g=function(){b.find(".jOn").show().end().find(".jOff").hide();d.fadeOut("fast",function(){e.fadeIn("fast")})},i=function(){m(function(h){d=a(h).appendTo(c);console.log(d);f()})};b.bind("click",function(h){h.preventDefault();
if(a(".jOn:visible",b).length>0)d===undefined?i():f();else g()})})}(jQuery);

